---
title: "Change DNS in Kali Linux"
header:
toc: true
toc_sticky: true
excerpt_separator:  <!--more-->
categories:
  - Hacking
tags:
  - Kali
  - Guides
  - DNS
  - Helpful
---

<!--more-->

## DNS
### DNS Definition

The Domain Name System (DNS) turns domain names into IP addresses, which browsers use to load internet pages. Every device connected to the internet has its own IP address, which is used by other devices to locate the device. DNS servers make it possible for people to input normal words into their browsers, such as google.com, without having to keep track of the IP address for every website.

### What is a DNS Server?

A DNS server is a computer with a database containing the public IP addresses associated with the names of the websites an IP address brings a user to. DNS acts like a phonebook for the internet. Whenever people type domain names, like Google.com or Yahoo.com, into the address bar of web browsers, the DNS finds the right IP address. The site’s IP address is what directs the device to go to the correct place to access the site’s data.

## resolv.conf
### Displaying current configuration of resolv.conf file

File resolv.conf is located on etc folder path in Kali linux.

- To display the file content we can use cat command
```text
libta@kali:~# cat /etc/resolv.conf
# Generated by NetworkManager
nameserver 192.168.1.1
```

### Install and start resolvconf service

By default, Kali doesn’t have the resolvconf service pre-installed.

- Use apt-get install command to install the service first
```text
libta@kali:~# sudo apt-get install resolvconf
Reading of package lists... Done
Building the dependency tree... Done
Read status information... Done      
The following NEW packages will be installed:
  resolvconf
0 updated, 1 newly installed, 0 to remove and 10 not updated.
It is necessary to take 0 o/73.9 kB from the archive.
After this operation, 201 kb of additional disk space will be used.
Package preconfiguration...
Selection of the resolvconf package previously deselected.
(Reading the database... 330210 files and directories already installed).
Preparing to unpack .../resolvconf_1.91_all.deb ...
Unpacking resolvconf (1.91) ...
Setting up resolvconf (1.91) ...
update-rc.d: We have no instructions for the resolvconf init script.
update-rc.d: It looks like a non-network service, we enable it.
resolvconf.service is a disabled or a static unit not running, not starting it.
Created symlink /etc/systemd/system/systemd-resolved.service.wants/resolvconf-pull-resolved.path → /lib/systemd/system/resolvconf-pull-resolved.path.
resolvconf-pull-resolved.service is a disabled or a static unit not running, not starting it.
Processing of triggers for kali-menu (2022.3.0) ...
Processing of deferred actions ("triggers") for man-db (2.10.2-1) ...                                                                                                   
Processing of deferred actions ("triggers") for resolvconf (1.91) ...
```

- We will check now the service status after hitting the start command to make sure service enters into an active state
```text
libta@kali:~# sudo systemctl enable resolvconf.systemctl
Syncronizing state of resolvconf.service with SysV service script with /lib/systemd/system-sysv-install.
Executing: /lib/systemd/systemd-sysv-install enable resolvconf
Created symlink /etc/systemd/system/sysinit.target.wants/resolvconf.service → /lib/systemd/system/resolvconf.service.
```
```text
libta@kali:~# sudo systemctl start resolvconf.service
libta@kali:~# sudo systemctl status resolvconf.service
 resolvconf.service - Nameserver information manager
    Loaded: loaded (/lib/systemd/system/resolvconf.service; enabled; vendor preset:>
    Active: active (exited) since Wed 2022-06-29 16:21:00 EDT; 10s ago
      Docs: man:resolvconf(8)
   Process: 21102 ExecStart=/sbin/resolvconf --enable-updates (code=exited, status=>
  Main PID: 21102 (code=exited, status=0/SUCESS)
 ESCOC
```

- Now you can check the status of resolv.conf file
```text
libta@kali:~# cat /etc/resolv.conf
# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#      DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
# 127.0.0.53 is the systemd-resolved stub resolver.
# run "systemd-resolve --status" to see details about the actual nameservers.

nameserver 192.168.1.1
```

### Modifying resolvconf base and resolv.conf file with new servers

- You can see that it is still pointing to my router gateway address. First we need to make changes in resolvconf base file and then we will modify network interfaces file
```text
libta@kali:~# sudo nano /etc/resolvconf/resolv.conf.d/base
```
Now you need to enter your desired set of nameserver details. I have used [CloudFlare](https://www.cloudflare.com/learning/dns/what-is-1.1.1.1/) and [Google public DNS](https://developers.google.com/speed/public-dns) IP Addresses for demonstartion.
```text
GNU nano 6.3          /etc/resolvconf/resolv.conf/base        Modified
nameserver 1.1.1.1
nameserver 8.8.8.8
nameserver 8.8.4.4
```
- Next we will modify the network interfaces file and will enter same set of DNS nameserver details
```text
libta@kali:~# sudo nano /etc/network/interfaces
```
- Now enter your dns-nameserver which can be anything or you can use public DNS servers
```text
# This file describes the network interfaces available on your sytem
# and how to activate them. For more information, see interfaces(5).

source /etc/network/interfaces.d/*

# The loopback network interface
auto lo
iface lo inet loopback

dns-nameserver 1.1.1.1 8.8.8.8 8.8.4.4
```
- Now type the command and modify like this
```text
libta@kali:~# sudo nano /etc/resolv.conf
```
```text
GNU nano 6.3           /etc/resolv.conf         Modified
# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
# 127.0.0.53 is the systemd-resolved stub resolver.
# run "resolvectl status" to see details about the actual nameservers.

nameserver 1.1.1.1
nameserver 8.8.8.8
nameserver 8.8.4.4
```
### NetworkManager & resolvconf service
- Restart NetworkManager service and resolvconf.service after making all changes.
When you restart your virtual machine or computer, you can see the resolvconf file modified.
```text
libta@kali:~# sudo systemctl restart NetworkManager
libta@kali:~# sudo systemctl restart resolvconf.service
libta@kali:~# cat /etc/resolv.conf
# Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
# 127.0.0.53 is the systemd-resolved stub resolver.
# run "resolvectl status" to see details about the actual nameservers.

nameserver 1.1.1.1
nameserver 8.8.8.8
nameserver 8.8.4.4
```
If you don’t see the changes in resolv.conf file as displayed here then you can restart your linux machine. Sometimes you have to restart the machine, but in most cases, restarting the service works.

## Conclusion

We have learned here, how to change DNS in Kali linux. These steps can work on other linux distributions too. Changing your DNS server offers several advantages such as avoiding a form of censorship, obtaining a faster DNS resolution, protecting yourself against hacking, or enjoying better performance.

Thanks for reading!
